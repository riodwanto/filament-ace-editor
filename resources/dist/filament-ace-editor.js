function m({state:n,statePath:h,placeholder:r,aceUrl:d,extensions:c,config:l={},options:e={},darkTheme:a,disableDarkTheme:o}){return{state:n,statePath:h,placeholder:r,options:e,darkTheme:a,disableDarkTheme:o,editor:null,observer:null,shouldUpdateState:!0,isDestroyed:!1,init(){this.initializeEditor()},async initializeEditor(){try{await this.loadScript(d);for(let[,t]of Object.entries(c))await this.loadScript(t);Object.entries(l).forEach(([t,i])=>{ace.config.set(t,i)}),this.editor=ace.edit(this.$refs.aceCodeEditor),this.editor.setOptions(e),this.editor.session.setValue(this.state||r),this.applyInitialTheme(),this.observeDarkModeChanges(),this.$watch("state",()=>{if(!this.isDestroyed){if(!this.shouldUpdateState){this.shouldUpdateState=!0;return}this.editor.isFocused()||this.editor.session.setValue(this.state||r)}}),this.editor.session.on("change",()=>{if(this.isDestroyed)return;let t=this.editor.getValue();this.state=t,this.shouldUpdateState=!1})}catch(t){console.error("Failed to initialize ACE editor:",t)}},loadScript(t){return new Promise((i,u)=>{let s=document.createElement("script");s.src=t,s.onload=i,s.onerror=u,document.head.appendChild(s)})},applyInitialTheme(){o?this.editor&&e.theme&&this.editor.setTheme(e.theme):this.setTheme()},observeDarkModeChanges(){if(o)return;let t=document.querySelector("html");this.observer=new MutationObserver(()=>this.setTheme()),this.observer.observe(t,{attributes:!0,attributeFilter:["class"]})},setTheme(){if(!this.editor)return;let i=document.querySelector("html").classList.contains("dark")?a:e.theme;this.editor.setTheme(i)}}}export{m as default};
